document.addEventListener("DOMContentLoaded", function () {

  const form = document.getElementById("pengeluaranForm");
  const jumlahInput = document.getElementById("jumlah");

  if (!form || !jumlahInput) {
    console.error("Form atau input jumlah tidak ditemukan");
    return;
  }

  /* ===============================
     AUTO FORMAT RUPIAH
  ================================ */
  jumlahInput.addEventListener("input", function () {
    let angka = this.value.replace(/[^0-9]/g, "");
    if (angka === "") {
      this.value = "";
      return;
    }
    this.value = formatRupiah(angka);
  });

  function formatRupiah(angka) {
    return angka.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  }

  /* ===============================
     SUBMIT + NOTIFIKASI
  ================================ */
  form.addEventListener("submit", function (e) {
    e.preventDefault();

    // Bersihkan format Rupiah
    const cleanJumlah = jumlahInput.value.replace(/\./g, "");
    jumlahInput.value = cleanJumlah;

    const formData = new FormData(form);

    fetch("PASTE_URL_WEB_APP_SCRIPT_DI_SINI", {
      method: "POST",
      body: formData
    })
      .then(res => res.text())
      .then(result => {
        alert("✅ Data berhasil dikirim");
        form.reset();
      })
      .catch(error => {
        console.error(error);
        alert("❌ Gagal mengirim data");
      });
  });

});
